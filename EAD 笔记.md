[TOC]

# 一、概述





## 1、狭义EDA

​	指的是在计算机平台上利用**EDA软件工具**，以**硬件描述**的方式对**大规模可编程器件**进行设计，自动完成**逻辑编译、综合、布局布线以及仿真测试**，从而达到电子系统功能要求的设计技术。



## 2、EDA 发展阶段

分 **4** 个阶段

1. CAD阶段（计算机辅助设计）

   > 早期，因为芯片设计并不复杂，人们使用手工绘图设计电路图等。随着复杂度的增加，人们开始使用计算机辅助设计。例如，电路图编辑软件。

2. CAE阶段（计算机辅助工程）

   > EDA技术进入发展和完善阶段，在上一阶段的基础上，发展了**逻辑模拟、时序分析、故障分析、自动布局布线**等核心工具。

3. EDA系统级设计

   > 标志：1980年，Carver Mead&Lynn Conway在其发表的论文《Introduction to VLSI Systems》中提出**通过编程语言进行芯片设计**的思想。
   >
   > ps：正是这一时期，EDA软件三巨头：Synopsys、Cadence、Mentor Graphic(Siemens EDA)崭露头角，并逐渐垄断市场。

4. 当代EDA阶段

   > 标志：基于IP核的SoC的设计方法，以及相应的EDA技术的发展的应用。





## 3、IP 核发展趋势

几个方面：

1. 技术与工艺结合愈发紧密

   > IP核技术作为集成电路的设计与制造的关键部分，其发展趋势与集成电路的发展趋势基本相同。
   >
   > 都是向着**工艺制程和精度尺寸不断缩小，产品集成度不断提高，整体性能不断提升**方向发展。

2. AI算法助力IP核研发

   > AI技术的发展带来了计算模型的变革，各大IP核供应厂商纷纷推出**为AI定制的，与AI结合**的IP核
   >
   > 例如：Synopsys 推出的高性能，嵌入式视觉处理器IP核——DesignWare EA系列，

3. IP核研发成平台化发展态势

   > 以**成套的工艺技术为基础，IC设计数据为核心，IP核为核心资产**的设计平台正在成为设计公司的核心竞争力。
   >
   > IP核平台的主要任务是设计公司急需的IP核，以及提供相应的设计技术服务，并将IP核的设计验证贯穿整个设计过程。

4. 开源IP核给供应商带来新的基于与挑战

   > 后摩尔时代，产品设计更加多样化。嵌入式处理器因其的灵活性，将迎来更大的市场空间。
   >
   > 嵌入式处理器一般以IP授权的商业模式运作，然而ARM公司高昂的IP授权费使得初创设计公司的创新成本大增
   >
   > 因此，在**中小公司的需求驱动下**，许多免费开源的IP核崭露头角。



## 4、EDA四要素

1. 软件开发工具
2. 硬件描述语言
3. 大规模可编程逻辑器件
4. 实验开发系统



### 1) VHDL versus Verilog



1. VHDL

   > 1981年诞生于美国国防部，有两个历史标准，分别为IEEE STD 1076-1987与IEEE STD 1076-1993

2. Verilog

   > 1983年，由Gateway Design Automation公司开发，95年在Cadence的推动下，正式推出IEEE STD 1364-1995
   >
   > 2001年，发布了IEEE STD 1364-2001版本，新增了VHDL HDL-A标准



**VHDL** 适用于行为级描述

**Verilog** 适用于RTL级和门级电路描述，描述风格接近原理图，所以综合过程更简单，效率更高。

因此VHDL适合大规模系统级设计



### 2) 大规模可编程逻辑器件



**通用标准集成电路** 不能适应快速变化的态势，于是专用集成电路（Application Specific Integrated Circuits，**ASIC**）应运而生。

然而，ASIC从设计到流片耗费大量的时间和资金，一旦出错需要修改设计，**成本**倍增。

当ASIC需求量不大而又要降低成本时，ASIC的 **验证任务** 就交给了**大规模可编程器件**。

所以，总的来说，像**FPGA**这种大规模可编程逻辑器件是**设计芯片**时候用的。



**PLD**是ASIC的一个重要分支，随之它的出现，设计师不需要到IC厂家流片验证、加工制造。自己在实验室就能对PLD进行设计，制造个性化的ASIC。

修改设计时，不用考虑成本，能随意进行修改。



最早的**PLD**是在1970年制成的**PROM**，到现在应用最广泛的PLD是**FPGA**、**CPLD**和**EPLD**。



1. PROM

   > 由**固定的与阵列**和**可编程的或阵列**组成，用熔丝工艺编程，只能写一次。不能擦除和重写。
   >
   > 价格低，编程简单

2. PLA

   > 由**可编程的与阵列**和**可编程的或阵列**组成。
   >
   > 编程复杂

3. PAL

   > **与阵列可编程**，**或阵列固定**。熔丝编程。

4. GAL

   > 在PAL基础上发展了**输出逻辑宏单元**，可电擦写，可重复编程。

5. EPLD

   > 是20世纪80年代，由Altera公司推出的。基于UVERROM和CMOS技术的PLD。
   >
   > 基本逻辑单元是宏单元。宏单元=**可编程与或阵列**+**可编程寄存器**+**可编程I/O**

6.  CPLD

   > 是20世纪80年代末，由Lattice公司推出的。
   >
   > 基于EPLD，包含**可编程逻辑模块**、**I/O单元**和**可编程内部连线**3部分结构。
   >
   > 编程结构为$E^2PROM$，非易失性。

7. FPGA

   > 1985年，由Xilinx公司首次推出。
   >
   > 基于CMOS-SRAM工艺，掉电易失。
   >
   > 结构分为 **可编程逻辑块**（CLB）、**可编程I/O模块**，**可编程内部连线模块**



### 3) 实验开发系统

一般包括：

1. 实验或开发所需的各类基本信号发生模块，如时钟、脉冲等
2. FPGA/CPLD 输出显示模块，如数码显示等
3. 目标芯片适配座和目标芯片编程/下载电路



 ## 5、EDA简要设计流程

1. 源程序的编辑和输入 Design Entry

   > 输入方式包括：**原理图输入方式、状态图输入方式、文本输入方式**

2. 逻辑综合和优化 Synthesis

   > 此过程将人能理解的电路**高级语言**转换为**器件能理解的低级语言**
   >
   > 并未涉及各元件之间的连接，仅仅列出设计所需的资源清单
   >
   > 输出：标准网表文件（edf、vqm）
   >

3. 目标器件的布线/适配 Fitter

   >根据综合产生的网表文件，进一步进行对目标器件的映射操作，
   >
   >确定所需逻辑资源在目标器件中的**位置以及它们之间的连接关系**。
   >
   >进而生成**顶层资源位置网表、映射报告以及布局信息、布局报告等**配置/下载文件
   >
   >输出：熔丝图、SRAM文件，VHDL/Verilog 网表文件

4. 目标器件的编程/下载 Progamming

   > 将适配器产生的配置/下载文件下载到目标器件，在目标器件中还原出配置文件中给出的电路结构。

5. 仿真（设计过程中）Simulation 

   >1. 行为仿真
   >
   >   直接将源程序送到仿真器进行仿真，根据语义进行的
   >
   >2. 功能仿真
   >
   >   将综合后生成的**网表文件**送到仿真器
   >
   >3. 时序仿真
   >
   >   将布线器/适配器产生的网表文件送到仿真器

6. 硬件仿真/硬件测试 

```mermaid
graph LR

A(源程序编辑输入)-->B(逻辑综合)-->C(布线/适配)-->D(编程/下载)-->E(仿真)-->F(硬件仿真)
```



## 6、编程与配置

编程：根据逻辑功能需求，编写设计输入上文件的过程。

配置：将输入的设计文件进行综合、布线/适配等过程产生的网表文件，布局布线信息等配置文件下载到目标器件中，目标器件根据配置/下载文件还原出电路结构的过程。





# 二、CPLD/FPGA 结与工作原理





## 1、CPLD

**CPLD（复杂可编程逻辑器件）**是在EPLD演变而来的，最终在**GAL（通用阵列逻辑）**上发展起来，其主体结构依然是基于**ROM工艺**的**可编程与阵列和乘积项共享的或阵列结构**。

### 内部组成部分

1. 通用逻辑单元

   > 与阵列实现乘积项，或阵列实现乘积项相加

2. 全局可编程布线区

3. 输入输出逻辑单元

   

## 2、FPGA

**FPGA（现场可编程门阵列）**属于一个高密度PLD。基于CMOS-SRAM工艺。

虽然FPGA也有可编程逻辑单元、I/O单元、连线资源，但是它们的内部结构和工作原理跟CPLD有着很大的区别。



### 1. 主要内部资源

1. CLB

   > CLB（可配置逻辑块）是FPGA的主要组成部分，是实现逻辑功能的主要单元。其中包括多个LUT（查找表）。

2. IOB（输入输出模块）

   > IOB提供了**器件引脚**与**内部逻辑阵列**之间的连接，通常排列在芯片的四周。

3. IR （可编程互联资源）

   > IR包括各种长度的金属连线线段和一些可编程连接开关，它们**将排列分散在各处CLB以及IOB互相连接起来**。

4. 时钟网络资源

5. PLL （锁相环）

6. Block RAM（数据缓存）



### 2. LUT

LUT是FPGA基于**SRAM**工艺，用**存储器**来构造的一个函数发生器。 这是FPGA与CPLD之间最大的区别。  

为了实现逻辑功能，PLD/FPGA开发软件会将所要实现的逻辑功能的**真值结果**计算出来，并存入RAM，最后输入信号进入逻辑电路就等于过通过**地址线查找表**，输出相应结果。



### 3. FPGA 供电机制

1. 外部接口供电

   >通常一块TQFP封装的144引脚的FPGA芯片将众多I/O资源划分为4个I/O bank，每个I/O bank 具有单独的VCCIO接口资源，以应对接口电平。
   >
   >这样一来，FPGA可能同时存在多种接口电平。
   >
   >这样的供电机制，可以满足不同的通信环境的不同电平要求。

2. 内部逻辑供电

   > 内部逻辑资源在正常工作时，只能有一种电平供电，给内部逻辑资源供电电源引脚一般命名为VCCINT。
   >
   > 这个内部逻辑资源供电电平有多种选择。



### 4. FPGA配置

当设计文件以某种输入形式输入后，经过**编译综合，布线适配**，最后得到与FPGA资源相映射的**网表文件**，这种网表文件必须经过**逻辑配置**，装载到FPGA芯片中，才能将设计付诸实践。**配置** 也称为**下载**



两种配置方案：

1. 掉电即丢的配置

   > 通过 **JTAG** 接口实现。
   >
   > JTAG这个组织在20世纪80年代组织开发了“边界扫描测试”技术规范。
   >
   > 自此多数CPLD/FPGA厂家在输入输出引脚，以及专用配置引脚上提供了边界扫描测试能力。
   >
   > FPGA一边利用JTAG口进行在线扫描测试和查错，另一方面这个口被用来与PC上的并口或USB进行连接。

2. 掉电不丢的配置

   * FPAG主动控制专用配置芯片

     > 一片或多片基于Flash或者EPROM结构的存储芯片作为配置器件与FPGA相接。例如，Altera公司提供的**EPC型号**的专用配置器件
     >
     > 在系统掉电时，配置器件上的数据不会丢失；系统重启时，FPGA提供的**专用配置电路**，将配置器件上的数据 **主动** 读入FPAG硬件。
     >
     > 这种方式保密性不佳

   * 用其他设备控制FPGA来完成配置

     >例如单片机、CPLD等，可以作为FPGA外挂的配置设备
     >
     >这些设备在上电后自动执行设定的程序，产生对FPGA的控制信号





## 3. CPLD vs FPGA

1. 制作工艺

   > CPLD 基于EPROM、$E^2PROM$、Flash工艺，数据不易失，配置简单，但配置次数有限
   >
   > FPGA 基于SRAM工艺，数据易失，配置相对复杂，理论上，配置下载次无限

2. 逻辑资源规模

   > FPGA的逻辑复杂度更高，逻辑资源规模更大，逻辑函数的实现能力更强大
   >
   > 就组合逻辑来说，CPLD更丰富，但触发器等时序逻辑资源比FPGA少

3. 实现逻辑设计的方式

   > CPLD：基于乘积项扩展的原理
   >
   > FPGA：基于查找表的逻辑结构

4. 延时预测

   > CPLD 连线资源长度固定，信号传输的时间具有**可预测性**。
   >
   > FPGA构成复杂系统时，信号传输路径的长短会因为所用的**逻辑单元数量不同**而各有不同，信号传输的时间**不可预测**

5. 成本与功耗

   > FPGA成本、价格更高，但功耗更低



# 三、VHDL结构与要素



对于一个集成芯片我们一般需考虑一下3方面：

1. 哪个公司产的，符合什么规范?

   > 库、程序包的使用说明，表明了电路是在什么规范下设计的

2. 各个引脚的职能是什么？

   > 实体的说明，表明了所设计电路与整个系统的接口信息

3. 实现了什么功能?

   > 结构体的说明，描述了所设计的硬件电路内部各组成部分的功能、相互之间的逻辑关系以及整个系统的逻辑功能。
